#!/bin/bash
gpu_info=$(lspci -vnn | grep VGA)
gpu_ids=($(echo "$gpu_info" | grep -o "\[[0-9a-fA-F]\{4\}:[0-9a-fA-F]\{4\}\]" | tr -d '[]'))

for gpu_id in "${gpu_ids[@]}"; do
    if [[ $gpu_id == *10de* ]]; then
        echo "NVIDIA GPU found with ID: $gpu_id"
        export HOLOISO_ENV_GAMESCOPEEXEC="gamescope-nvidia"
        export HOLOISO_GPU_TYPE="nv"
        export HOLOISO_GPU_FIXES="nvidia_drm.modeset=1"
        break
    else
        echo "Non-NVIDIA GPU found with ID: $gpu_id"
        export HOLOISO_ENV_GAMESCOPEEXEC="gamescope"
        export HOLOISO_GPU_TYPE="mesa"
    fi
done